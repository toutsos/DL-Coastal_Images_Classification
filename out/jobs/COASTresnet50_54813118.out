[rank: 0] Seed set to 42
Using model without pretrained weights
Trainable parameters:
0.conv1.weight: True
0.bn1.weight: True
0.bn1.bias: True
0.layer1.0.conv1.weight: True
0.layer1.0.bn1.weight: True
0.layer1.0.bn1.bias: True
0.layer1.0.conv2.weight: True
0.layer1.0.bn2.weight: True
0.layer1.0.bn2.bias: True
0.layer1.0.conv3.weight: True
0.layer1.0.bn3.weight: True
0.layer1.0.bn3.bias: True
0.layer1.0.downsample.0.weight: True
0.layer1.0.downsample.1.weight: True
0.layer1.0.downsample.1.bias: True
0.layer1.1.conv1.weight: True
0.layer1.1.bn1.weight: True
0.layer1.1.bn1.bias: True
0.layer1.1.conv2.weight: True
0.layer1.1.bn2.weight: True
0.layer1.1.bn2.bias: True
0.layer1.1.conv3.weight: True
0.layer1.1.bn3.weight: True
0.layer1.1.bn3.bias: True
0.layer1.2.conv1.weight: True
0.layer1.2.bn1.weight: True
0.layer1.2.bn1.bias: True
0.layer1.2.conv2.weight: True
0.layer1.2.bn2.weight: True
0.layer1.2.bn2.bias: True
0.layer1.2.conv3.weight: True
0.layer1.2.bn3.weight: True
0.layer1.2.bn3.bias: True
0.layer2.0.conv1.weight: True
0.layer2.0.bn1.weight: True
0.layer2.0.bn1.bias: True
0.layer2.0.conv2.weight: True
0.layer2.0.bn2.weight: True
0.layer2.0.bn2.bias: True
0.layer2.0.conv3.weight: True
0.layer2.0.bn3.weight: True
0.layer2.0.bn3.bias: True
0.layer2.0.downsample.0.weight: True
0.layer2.0.downsample.1.weight: True
0.layer2.0.downsample.1.bias: True
0.layer2.1.conv1.weight: True
0.layer2.1.bn1.weight: True
0.layer2.1.bn1.bias: True
0.layer2.1.conv2.weight: True
0.layer2.1.bn2.weight: True
0.layer2.1.bn2.bias: True
0.layer2.1.conv3.weight: True
0.layer2.1.bn3.weight: True
0.layer2.1.bn3.bias: True
0.layer2.2.conv1.weight: True
0.layer2.2.bn1.weight: True
0.layer2.2.bn1.bias: True
0.layer2.2.conv2.weight: True
0.layer2.2.bn2.weight: True
0.layer2.2.bn2.bias: True
0.layer2.2.conv3.weight: True
0.layer2.2.bn3.weight: True
0.layer2.2.bn3.bias: True
0.layer2.3.conv1.weight: True
0.layer2.3.bn1.weight: True
0.layer2.3.bn1.bias: True
0.layer2.3.conv2.weight: True
0.layer2.3.bn2.weight: True
0.layer2.3.bn2.bias: True
0.layer2.3.conv3.weight: True
0.layer2.3.bn3.weight: True
0.layer2.3.bn3.bias: True
0.layer3.0.conv1.weight: True
0.layer3.0.bn1.weight: True
0.layer3.0.bn1.bias: True
0.layer3.0.conv2.weight: True
0.layer3.0.bn2.weight: True
0.layer3.0.bn2.bias: True
0.layer3.0.conv3.weight: True
0.layer3.0.bn3.weight: True
0.layer3.0.bn3.bias: True
0.layer3.0.downsample.0.weight: True
0.layer3.0.downsample.1.weight: True
0.layer3.0.downsample.1.bias: True
0.layer3.1.conv1.weight: True
0.layer3.1.bn1.weight: True
0.layer3.1.bn1.bias: True
0.layer3.1.conv2.weight: True
0.layer3.1.bn2.weight: True
0.layer3.1.bn2.bias: True
0.layer3.1.conv3.weight: True
0.layer3.1.bn3.weight: True
0.layer3.1.bn3.bias: True
0.layer3.2.conv1.weight: True
0.layer3.2.bn1.weight: True
0.layer3.2.bn1.bias: True
0.layer3.2.conv2.weight: True
0.layer3.2.bn2.weight: True
0.layer3.2.bn2.bias: True
0.layer3.2.conv3.weight: True
0.layer3.2.bn3.weight: True
0.layer3.2.bn3.bias: True
0.layer3.3.conv1.weight: True
0.layer3.3.bn1.weight: True
0.layer3.3.bn1.bias: True
0.layer3.3.conv2.weight: True
0.layer3.3.bn2.weight: True
0.layer3.3.bn2.bias: True
0.layer3.3.conv3.weight: True
0.layer3.3.bn3.weight: True
0.layer3.3.bn3.bias: True
0.layer3.4.conv1.weight: True
0.layer3.4.bn1.weight: True
0.layer3.4.bn1.bias: True
0.layer3.4.conv2.weight: True
0.layer3.4.bn2.weight: True
0.layer3.4.bn2.bias: True
0.layer3.4.conv3.weight: True
0.layer3.4.bn3.weight: True
0.layer3.4.bn3.bias: True
0.layer3.5.conv1.weight: True
0.layer3.5.bn1.weight: True
0.layer3.5.bn1.bias: True
0.layer3.5.conv2.weight: True
0.layer3.5.bn2.weight: True
0.layer3.5.bn2.bias: True
0.layer3.5.conv3.weight: True
0.layer3.5.bn3.weight: True
0.layer3.5.bn3.bias: True
0.layer4.0.conv1.weight: True
0.layer4.0.bn1.weight: True
0.layer4.0.bn1.bias: True
0.layer4.0.conv2.weight: True
0.layer4.0.bn2.weight: True
0.layer4.0.bn2.bias: True
0.layer4.0.conv3.weight: True
0.layer4.0.bn3.weight: True
0.layer4.0.bn3.bias: True
0.layer4.0.downsample.0.weight: True
0.layer4.0.downsample.1.weight: True
0.layer4.0.downsample.1.bias: True
0.layer4.1.conv1.weight: True
0.layer4.1.bn1.weight: True
0.layer4.1.bn1.bias: True
0.layer4.1.conv2.weight: True
0.layer4.1.bn2.weight: True
0.layer4.1.bn2.bias: True
0.layer4.1.conv3.weight: True
0.layer4.1.bn3.weight: True
0.layer4.1.bn3.bias: True
0.layer4.2.conv1.weight: True
0.layer4.2.bn1.weight: True
0.layer4.2.bn1.bias: True
0.layer4.2.conv2.weight: True
0.layer4.2.bn2.weight: True
0.layer4.2.bn2.bias: True
0.layer4.2.conv3.weight: True
0.layer4.2.bn3.weight: True
0.layer4.2.bn3.bias: True
1.0.weight: True
1.0.bias: True
Trainable layers after freeze_layers():
  0.conv1.weight
  0.bn1.weight
  0.bn1.bias
  0.layer1.0.conv1.weight
  0.layer1.0.bn1.weight
  0.layer1.0.bn1.bias
  0.layer1.0.conv2.weight
  0.layer1.0.bn2.weight
  0.layer1.0.bn2.bias
  0.layer1.0.conv3.weight
  0.layer1.0.bn3.weight
  0.layer1.0.bn3.bias
  0.layer1.0.downsample.0.weight
  0.layer1.0.downsample.1.weight
  0.layer1.0.downsample.1.bias
  0.layer1.1.conv1.weight
  0.layer1.1.bn1.weight
  0.layer1.1.bn1.bias
  0.layer1.1.conv2.weight
  0.layer1.1.bn2.weight
  0.layer1.1.bn2.bias
  0.layer1.1.conv3.weight
  0.layer1.1.bn3.weight
  0.layer1.1.bn3.bias
  0.layer1.2.conv1.weight
  0.layer1.2.bn1.weight
  0.layer1.2.bn1.bias
  0.layer1.2.conv2.weight
  0.layer1.2.bn2.weight
  0.layer1.2.bn2.bias
  0.layer1.2.conv3.weight
  0.layer1.2.bn3.weight
  0.layer1.2.bn3.bias
  0.layer2.0.conv1.weight
  0.layer2.0.bn1.weight
  0.layer2.0.bn1.bias
  0.layer2.0.conv2.weight
  0.layer2.0.bn2.weight
  0.layer2.0.bn2.bias
  0.layer2.0.conv3.weight
  0.layer2.0.bn3.weight
  0.layer2.0.bn3.bias
  0.layer2.0.downsample.0.weight
  0.layer2.0.downsample.1.weight
  0.layer2.0.downsample.1.bias
  0.layer2.1.conv1.weight
  0.layer2.1.bn1.weight
  0.layer2.1.bn1.bias
  0.layer2.1.conv2.weight
  0.layer2.1.bn2.weight
  0.layer2.1.bn2.bias
  0.layer2.1.conv3.weight
  0.layer2.1.bn3.weight
  0.layer2.1.bn3.bias
  0.layer2.2.conv1.weight
  0.layer2.2.bn1.weight
  0.layer2.2.bn1.bias
  0.layer2.2.conv2.weight
  0.layer2.2.bn2.weight
  0.layer2.2.bn2.bias
  0.layer2.2.conv3.weight
  0.layer2.2.bn3.weight
  0.layer2.2.bn3.bias
  0.layer2.3.conv1.weight
  0.layer2.3.bn1.weight
  0.layer2.3.bn1.bias
  0.layer2.3.conv2.weight
  0.layer2.3.bn2.weight
  0.layer2.3.bn2.bias
  0.layer2.3.conv3.weight
  0.layer2.3.bn3.weight
  0.layer2.3.bn3.bias
  0.layer3.0.conv1.weight
  0.layer3.0.bn1.weight
  0.layer3.0.bn1.bias
  0.layer3.0.conv2.weight
  0.layer3.0.bn2.weight
  0.layer3.0.bn2.bias
  0.layer3.0.conv3.weight
  0.layer3.0.bn3.weight
  0.layer3.0.bn3.bias
  0.layer3.0.downsample.0.weight
  0.layer3.0.downsample.1.weight
  0.layer3.0.downsample.1.bias
  0.layer3.1.conv1.weight
  0.layer3.1.bn1.weight
  0.layer3.1.bn1.bias
  0.layer3.1.conv2.weight
  0.layer3.1.bn2.weight
  0.layer3.1.bn2.bias
  0.layer3.1.conv3.weight
  0.layer3.1.bn3.weight
  0.layer3.1.bn3.bias
  0.layer3.2.conv1.weight
  0.layer3.2.bn1.weight
  0.layer3.2.bn1.bias
  0.layer3.2.conv2.weight
  0.layer3.2.bn2.weight
  0.layer3.2.bn2.bias
  0.layer3.2.conv3.weight
  0.layer3.2.bn3.weight
  0.layer3.2.bn3.bias
  0.layer3.3.conv1.weight
  0.layer3.3.bn1.weight
  0.layer3.3.bn1.bias
  0.layer3.3.conv2.weight
  0.layer3.3.bn2.weight
  0.layer3.3.bn2.bias
  0.layer3.3.conv3.weight
  0.layer3.3.bn3.weight
  0.layer3.3.bn3.bias
  0.layer3.4.conv1.weight
  0.layer3.4.bn1.weight
  0.layer3.4.bn1.bias
  0.layer3.4.conv2.weight
  0.layer3.4.bn2.weight
  0.layer3.4.bn2.bias
  0.layer3.4.conv3.weight
  0.layer3.4.bn3.weight
  0.layer3.4.bn3.bias
  0.layer3.5.conv1.weight
  0.layer3.5.bn1.weight
  0.layer3.5.bn1.bias
  0.layer3.5.conv2.weight
  0.layer3.5.bn2.weight
  0.layer3.5.bn2.bias
  0.layer3.5.conv3.weight
  0.layer3.5.bn3.weight
  0.layer3.5.bn3.bias
  0.layer4.0.conv1.weight
  0.layer4.0.bn1.weight
  0.layer4.0.bn1.bias
  0.layer4.0.conv2.weight
  0.layer4.0.bn2.weight
  0.layer4.0.bn2.bias
  0.layer4.0.conv3.weight
  0.layer4.0.bn3.weight
  0.layer4.0.bn3.bias
  0.layer4.0.downsample.0.weight
  0.layer4.0.downsample.1.weight
  0.layer4.0.downsample.1.bias
  0.layer4.1.conv1.weight
  0.layer4.1.bn1.weight
  0.layer4.1.bn1.bias
  0.layer4.1.conv2.weight
  0.layer4.1.bn2.weight
  0.layer4.1.bn2.bias
  0.layer4.1.conv3.weight
  0.layer4.1.bn3.weight
  0.layer4.1.bn3.bias
  0.layer4.2.conv1.weight
  0.layer4.2.bn1.weight
  0.layer4.2.bn1.bias
  0.layer4.2.conv2.weight
  0.layer4.2.bn2.weight
  0.layer4.2.bn2.bias
  0.layer4.2.conv3.weight
  0.layer4.2.bn3.weight
  0.layer4.2.bn3.bias
  1.0.weight
  1.0.bias
Frozen layers after freeze_layers():
Error executing job with overrides: ['datamodule.batch_size=64', 'datamodule.num_workers=3', 'module.lr=1e-2', 'module.momentum=0.0', 'module.nesterov=false', 'module.weight_decay=0.0', 'module.use_pretrained= false', 'module.fine_tune= true', 'trainer.num_nodes=1', 'trainer.precision=32-true', 'trainer.max_epochs=10', 'trainer.accelerator=auto', 'trainer.strategy=auto', 'trainer.devices=auto', 'trainer.sync_batchnorm=false', 'trainer.gradient_clip_val=null', 'trainer.gradient_clip_algorithm=norm', 'trainer.profiler=simple', 'paths.output_dir=out/2025-01-27_22-17-59', 'paths.data_dir=/home/angelos.toutsios.gr/data/CS4321/HW1/teamsmt/data']
Traceback (most recent call last):
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/src/modules/model.py", line 94, in __init__
    self.batch_norm = nn.BatchNorm2d(num_features=model.conv1.in_channels)
                                                  ^^^^^^^^^^^
  File "/home/angelos.toutsios.gr/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1931, in __getattr__
    raise AttributeError(
AttributeError: 'Sequential' object has no attribute 'conv1'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/src/train.py", line 48, in <module>
    main()
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/src/train.py", line 45, in main
    train(cfg)
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/src/train.py", line 23, in train
    model: pl.LightningModule = hydra.utils.instantiate(cfg.module)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/angelos.toutsios.gr/CS4321/HW1/teamsmt/.pixi/envs/default/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.modules.model.COASTALResNet50':
AttributeError("'Sequential' object has no attribute 'conv1'")
full_key: module
srun: error: compute-8-10: task 0: Exited with exit code 1
